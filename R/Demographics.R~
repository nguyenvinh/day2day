
SummarizeContinuousDefault <- function(x, group, decimal=2, na.rm=TRUE, ...){
  mu <- formatC(tapply(x, group, mean, na.rm=na.rm), format="f", digits=decimal)
  sd <- formatC(tapply(x, group, sd, na.rm=na.rm), format="f", digits=decimal)
  ##return(paste(mu, "+/-", sd, sep=" "))
  return(paste(mu, "$\\pm$", sd, sep=" "))
}

SummarizeFactorDefault <- function(x, group, decimal=0, useNA="ifany", ...){
  counts <- table(x, group, useNA=useNA)
  pct <- formatC(counts / matrix(colSums(counts), nrow=nrow(counts), ncol=ncol(counts), byrow=TRUE)*100, format="f", digits=decimal)
  rslt <- matrix(paste(counts, " (", pct, "\\%", ")", sep=""), ncol=ncol(counts))
  rownames(rslt) <- rownames(counts)
  colnames(rslt) <- colnames(counts)
  return(rslt)
}

SummarizeVar <- function(x, group, continuous.summary.function=SummarizeContinuousDefault, factor.summary.function=SummarizeFactorDefault, ...){
  if(any(is.na(group))) stop("group must not contain NA.")
  if(is.numeric(x)) rslt <- continuous.summary.function(x, group, ...)
  else if(is.factor(x)) rslt <- factor.summary.function(x, group, ...)
  else stop("x needs to be numeric or factor.")
  return(rslt)
}

paste.column <- function(x, sep=" "){
  ##stopifnot(is.data.frame(x) | is.matrix(x))
  sep2 <- sep
  if(is.data.frame(x) | is.matrix(x)){
    n <- ncol(x)
    string2eval <- paste("paste(", paste("x[, ", 1:n, "]", sep="", collapse=", "), ", sep=\"", sep2, "\"", ")", sep="")
    rslt <- eval(parse(text=string2eval))
  } else
  if(is.vector(x)){
    rslt <- paste(x, collapse=sep2)
  }
  return(rslt)
}
