## vector of files
## get my own function for upper and lower case
LatexTable2html <- function(tex.files, big.out.file)
{
  require(R.utils) ## tolower() function
  if(!all(tolower(substr(tex.files, start=nchar(tex.files)-3, nchar(tex.files))) == ".tex")) stop("Not all files in tex.files end in '.tex'.")
  if(length(tex.files)>1) stopifnot(!missing(big.out.file))
  base.names <- substr(tex.files, start=1, nchar(tex.files)-4)
  html.files <- paste(base.names, "html", sep=".")
  for(i in 1:length(tex.files)){
    system(paste("echo '\\documentclass{article}' | cat -", tex.files[i], "| tth >", html.files[i], sep=" ")) ## need \documentclass{article} to get caption working
    cat("GENERATED:", html.files[i], "\n")
  }
  ##pdfFiles <- paste(baseName, "pdf", sep=".")
  ##return(cbind(base.names, html.files))
  if(!missing(big.out.file)){
    system(paste("echo '\\documentclass{article}' | cat -", paste(tex.files, collapse=" "), "| tth >", big.out.file, sep=" ")) ## need \documentclass{article} to get caption working
    cat("GENERATED:", big.out.file, "\n")
  }
  invisible(NULL)
}

LatexTable2html(c("Table-BaselineCharacteristics.tex", "Table-ResultsPrimary.tex"), "Table.html")

TableNewLine <- function(...){
  cat(" \\\\\n")
}
hline <- function(n=1, ...) {
  cat(paste(rep("\\hline", n), collapse="\n"))
  cat("\n")
}

BeginTable <- function(loc, ...) {
  if(missing(loc)) {
    cat("\\begin{table}\n")
  } else {
    cat(paste("\\begin{table}[", loc, "]\n", sep=""))
  }
}

BeginTabular <- function(align, hline.num=1, ...) {
  cat(paste("\\begin{tabular}{", align, "}\n", sep=""))
  hline(hline.num)
}

caption <- function(caption, ...) {
  cat("\\caption{", caption, "}\n", sep="")
}

label <- function(label, ...) {
  cat("\\label{", label, "}\n", sep="")
}

EndTabular <- function(hline.num=1, ...) {
  hline(hline.num)
  cat("\\end{tabular}\n")
}

EndTable <- function(...) {
  cat("\\end{table}\n")
}

